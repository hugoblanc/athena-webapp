<div class="law-proposals-container">
  <!-- Header -->
  <div class="page-header">
    <h1 class="page-title">Propositions de loi</h1>
    <p class="page-subtitle">Explorez les propositions de loi simplifiées par l'IA</p>
  </div>

  <!-- Filters -->
  <mat-card class="filters-card">
    <form [formGroup]="filterForm" class="filters-form">
      <mat-form-field appearance="outline">
        <mat-label>Groupe politique</mat-label>
        <mat-select formControlName="groupePolitique">
          <mat-option value="">Tous</mat-option>
          <mat-option *ngFor="let group of politicalGroups | keyvalue" [value]="group.key">
            {{ group.value.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Type</mat-label>
        <mat-select formControlName="typeProposition">
          <mat-option value="">Tous</mat-option>
          <mat-option *ngFor="let type of proposalTypes" [value]="type.value">
            {{ type.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Statut simplification</mat-label>
        <mat-select formControlName="simplificationStatus">
          <mat-option value="">Tous</mat-option>
          <mat-option *ngFor="let status of simplificationStatuses" [value]="status.value">
            {{ status.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Trier par</mat-label>
        <mat-select formControlName="sort">
          <mat-option *ngFor="let option of sortOptions" [value]="option.value">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <button mat-stroked-button type="button" (click)="clearFilters()" class="clear-filters-btn">
        <mat-icon>clear</mat-icon>
        Réinitialiser
      </button>
    </form>
  </mat-card>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Chargement des propositions...</p>
  </div>

  <!-- Proposals List -->
  <div class="proposals-list" *ngIf="!isLoading && proposals.length > 0">
    <mat-card class="proposal-card" *ngFor="let proposal of proposals" (click)="viewProposal(proposal.numero)">
      <!-- Header with number and type -->
      <div class="proposal-header">
        <span class="proposal-number">{{ proposal.numero }}</span>
        <span class="proposal-type" [class.constitutional]="proposal.typeProposition === 'constitutionnelle'">
          {{ proposal.typeProposition === 'constitutionnelle' ? 'Constitutionnelle' : 'Ordinaire' }}
        </span>
        <span class="proposal-status" [style.background-color]="getStatusColor(proposal.simplified.status)">
          {{ getStatusLabel(proposal.simplified.status) }}
        </span>
      </div>

      <!-- Title -->
      <h2 class="proposal-title">{{ proposal.titre }}</h2>

      <!-- Author and co-signatories -->
      <div class="proposal-author">
        <div class="author-info">
          <img *ngIf="proposal.auteur.photoUrl" [src]="proposal.auteur.photoUrl" [alt]="proposal.auteur.nom" class="author-photo">
          <div class="author-details">
            <div class="author-name">{{ proposal.auteur.nom }}</div>
            <div class="author-group" [style.color]="getPoliticalGroupColor(proposal.auteur.groupePolitiqueCode)">
              {{ getPoliticalGroupName(proposal.auteur.groupePolitiqueCode) }}
            </div>
          </div>
        </div>
        <div class="cosignatories" *ngIf="proposal.coSignatairesCount > 0">
          <mat-icon>group</mat-icon>
          <span>{{ proposal.coSignatairesCount }} cosignataire{{ proposal.coSignatairesCount > 1 ? 's' : '' }}</span>
        </div>
      </div>

      <!-- Key points (simplified version) -->
      <div class="key-points" *ngIf="proposal.simplified.status === 'completed' && proposal.simplified.keyPoints.length > 0">
        <div class="key-point" *ngFor="let point of proposal.simplified.keyPoints">
          <mat-icon>check_circle</mat-icon>
          <span>{{ point }}</span>
        </div>
      </div>

      <!-- Date -->
      <div class="proposal-date">
        <mat-icon>calendar_today</mat-icon>
        <span>Mise en ligne le {{ proposal.dateMiseEnLigne | date: 'dd/MM/yyyy' }}</span>
        <span *ngIf="proposal.dateDepot"> • Déposée le {{ proposal.dateDepot | date: 'dd/MM/yyyy' }}</span>
      </div>
    </mat-card>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && proposals.length === 0">
    <mat-icon>inbox</mat-icon>
    <h3>Aucune proposition trouvée</h3>
    <p>Essayez de modifier vos filtres</p>
  </div>

  <!-- Pagination -->
  <mat-paginator
    *ngIf="pagination && !isLoading"
    [length]="pagination.total"
    [pageSize]="pagination.limit"
    [pageIndex]="pagination.page - 1"
    [pageSizeOptions]="[10, 20, 50]"
    (page)="onPageChange($event)"
    showFirstLastButtons>
  </mat-paginator>
</div>
